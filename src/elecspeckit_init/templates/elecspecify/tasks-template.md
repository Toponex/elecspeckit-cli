# 任务: [硬件特性名称]

**输入**: 来自 `specs/[###-feature-name]/` 的规范与计划文档  
**先决条件**: `plan.md`（必需）、`spec.md`（用户故事必需）、`research.md`、`data-model.md`、`contracts/`、`quickstart.md`（如有）。  

**测试要求**: 根据项目宪法的验证驱动设计原则，硬件项目的测试分为三个层级：
- **L1 计算与仿真**（可编程）：参数计算脚本、SPICE 仿真验证 - 编写测试脚本
- **L2 样机功能测试**（部分可编程）：输出电压、纹波、效率等 - 编写测试方案 + 可选自动化脚本
- **L3 环境与认证测试**（不可编程）：温度循环、EMC、安规等 - 编写送测计划  

**本地化**: 所有任务描述默认使用中文，文件路径与技术术语保持英文一致性。  

## 格式: `[ID] [P?] [故事] 描述`  

- 任务格式必须为：`- [ ] T0XX [P?] [USn?] 描述 + 文件路径`。  
- **[P]**: 可并行执行（不同文件、无直接依赖）。  
- **[USn]**: 指明该任务主要服务的用户故事（例如 `[US1]`、`[US2]`）。  

示例：

- `- [ ] T001 创建 ElecSpeckit CLI 的基本项目结构`
- `- [ ] T005 [P] [US1] [L1] 在 tests/unit/test_transformer_design.py 中编写变压器设计算法的单元测试`
- `- [ ] T006 [P] [US1] [L2] 编写输出电压测试方案 - docs/test_plans/output_voltage_plan.md`
- `- [ ] T007 [P] [US1] [L3] 编写 EMC 认证送测计划 - docs/test_plans/emc_certification_plan.md`  

## 阶段1：设置（共享基础设施）

> 目标：确保规范、计划和 CLI 包的基础结构就绪。  

- [ ] T00X 检查 `spec.md`、`plan.md` 等核心文档是否存在且与当前硬件特性一致  
- [ ] T00X [P] 配置 CLI 包的入口与版本信息（例如 `pyproject.toml` 中的 `elecspeckit` 命令）  

---

## 阶段2：基础（阻塞先决条件）

> 目标：在实现具体用户故事前，为 CLI 行为和测试奠定基础结构。  

- [ ] T01X 在 `tests/unit/` 中创建针对关键命令的单元测试骨架  
- [ ] T01X [P] 在 `tests/integration/` 中创建端到端集成测试骨架  
- [ ] T01X [P] 在 `tests/contract/` 中创建契约测试骨架  

---

## 阶段3：用户故事 1 - [简要标题] (P1)

**目标**: [硬件特性针对 US1 的具体目标，例如“在空目录中初始化 Elecspeckit 项目结构”]  

### 用户故事1的测试 (强制性) ⚠️

**L1 计算与仿真测试**（可编程，快速反馈）：
- [ ] T01X [P] [US1] [L1] 在 `tests/unit/` 中编写参数计算脚本的单元测试
- [ ] T01X [P] [US1] [L1] 在 `simulation/` 中建立 SPICE 仿真模型并验证关键参数

**L2 样机功能测试**（需硬件，部分可自动化）：
- [ ] T01X [P] [US1] [L2] 编写 US1 功能测试方案 - `docs/test_plans/us1_functional_test_plan.md`
- [ ] T01X [P] [US1] [L2]（可选）编写测试自动化脚本 - `scripts/test_us1_auto.py`（通过仪器 API）
- [ ] T01X [US1] [L2] 执行样机测试并记录结果 - `docs/test_reports/us1_test_report.md`

**L3 环境与认证测试**（需专业设备/第三方，不可自动化）：
- [ ] T01X [P] [US1] [L3] 编写环境测试送测计划 - `docs/test_plans/us1_environmental_plan.md`（如需要）  

### 用户故事1的实现

- [ ] T01X [US1] 在 `packages/.../cli.py` 中实现核心逻辑  
- [ ] T01X [P] [US1] 在 `packages/.../templates/` 下补充或修正相关模板  
- [ ] T01X [P] [US1] 更新 `specs/[###-feature-name]/quickstart.md`，增加对应使用示例  

> **检查点**: 完成本阶段后，US1 应可在示例硬件项目中独立验证。  

---

## 阶段4：用户故事 2 - [简要标题] (P2)

> 同样结构：先测试，再实现，再文档更新。  

---

## 阶段5：用户故事 3 - [简要标题] (P3)

> 同样结构。  

---

## 阶段N：优化和跨领域关注点

**目的**: 针对多个用户故事或跨切关注点进行优化和治理。  

- [ ] T0YX [P] 清理历史遗留结构或不再使用的模板/脚本  
- [ ] T0YX [P] 改进日志、本地化、性能等横向能力（对应 SC 系列成功标准）  
- [ ] T0YX 在 `spec.md` 或 `plan.md` 中更新“需求覆盖概览”或复杂性跟踪小节  

---

## 依赖关系和执行顺序

- 阶段 1 是所有后续工作的基础；
- 阶段 2 完成后，用户故事阶段可以按优先级逐步推进；
- 每个用户故事内，**测试任务应先于实现任务执行**：
  - **L1**（计算/仿真）：先编写测试脚本，再编写实现脚本（TDD）
  - **L2**（样机测试）：先编写测试方案，再执行样机测试（方案驱动）
  - **L3**（认证测试）：先编写送测计划，再准备样品送测（计划驱动）
- 标记为 `[P]` 的任务可在不争用同一文件的前提下并行执行。  

