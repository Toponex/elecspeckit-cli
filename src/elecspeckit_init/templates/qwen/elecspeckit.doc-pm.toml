description = "为项目经理生成项目管理视图文档"

prompt = """---
description: 为项目经理生成项目管理视图文档
handoffs: []
---

## Command: `/elecspeckit.doc-pm`

**Goal**
基于当前硬件特性的 `spec.md` 和 `tasks.md`，为项目经理（PM）生成专属的项目管理视图文档 `docs/pm-view.md`，聚焦用户故事优先级、项目里程碑、风险跟踪和交付进度。

**Execution Steps (for the AI assistant)**
1. 在目标项目根目录工作，与用户确认当前特性的 `FEATURE_DIR = specs/00X-shortname/`，并在其中定位：
   - `FEATURE_SPEC   = FEATURE_DIR/spec.md`；
   - `FEATURE_TASKS  = FEATURE_DIR/tasks.md`；
   - `FEATURE_DOCS   = FEATURE_DIR/docs/`（如不存在，则创建）。

2. 从 `spec.md` 中提取用户故事优先级：
   - 读取 `spec.md` 中的用户故事章节（如"User Stories"）；
   - 识别每个用户故事的优先级标记（P1/P2/P3）；
   - P1 = 核心功能（必须实现），P2 = 重要功能（通常需要），P3 = 增值功能（可选）；
   - 统计各优先级的用户故事数量和完成情况。

3. 从 `tasks.md` 中提取 `[VIEW:PM]` 标记的任务：
   - 扫描 `tasks.md` 中所有任务描述；
   - 筛选包含 `[VIEW:PM]` 标记的任务；
   - 这些任务通常涉及项目里程碑、风险跟踪、沟通协调等。

4. 从 `tasks.md` 中识别项目里程碑：
   - 扫描 `tasks.md` 中的阶段划分（如"Phase 1: 需求分析"、"Phase 2: 架构设计"）；
   - 识别每个阶段的关键里程碑（如"完成原理图设计"、"通过EMC测试"）；
   - 提取里程碑的目标日期、状态（已完成/进行中/待开始）；
   - 如任务列表中未明确里程碑，从任务依赖关系推导（如"所有P1任务完成"可作为里程碑）。

5. 识别项目风险：
   - 从 `spec.md`、`plan.md` 和 `tasks.md` 中识别风险提示（如"长交期器件"、"新技术验证"）；
   - 分类风险：技术风险、供应链风险、时间风险、成本风险；
   - 评估风险等级（高/中/低）和影响（阻塞/延期/成本增加）；
   - 提取风险缓解措施（如"备选方案"、"提前采购"）。

6. 统计项目进度：
   - 按优先级（P1/P2/P3）统计任务完成率；
   - 按阶段统计任务完成率；
   - 识别关键路径上的待完成任务；
   - 识别延期风险（如"P1任务T050已延期2天"）。

7. 生成 `FEATURE_DIR/docs/pm-view.md`：
   - **项目概览**：特性名称、优先级、目标交付日期、当前状态；
   - **用户故事优先级**：列出P1/P2/P3用户故事及其完成情况；
   - **项目里程碑**：列出关键里程碑、目标日期、实际日期、状态；
   - **任务进度统计**：按优先级和阶段统计任务完成率；
   - **风险跟踪**：列出识别的风险、风险等级、缓解措施、责任人；
   - **关键路径**：标识阻塞项目进度的关键任务；
   - **下一步行动**：列出PM需要推动的优先事项。

8. 向用户总结：
   - 本次生成的 `pm-view.md` 包含了哪些里程碑和风险；
   - 当前项目进度（如"P1任务完成率80%，整体进度符合预期"）；
   - 提醒关注的高风险项或延期任务；
   - 建议下一步操作（如"推动供应商确认交期"、"协调资源支持EMC测试"）。

**Notes**
- `/elecspeckit.doc-pm` 专注于项目经理视角，不涉及技术细节；
- 项目里程碑应基于 `tasks.md` 的阶段划分和任务依赖关系，确保合理性；
- `[VIEW:PM]` 标记用于在 `tasks.md` 中标识PM关注的任务（如重要决策点、对外交付物）；
- 风险跟踪应持续更新，每次执行 `/elecspeckit.doc-pm` 时基于最新信息刷新风险列表。

**Example: PM视图文档结构**

```markdown
# 项目管理视图: 60W PD充电头

## 项目概览

- **特性名称**: 60W USB PD充电头
- **特性编号**: 001-60w-pd-charger
- **优先级**: P1（核心产品）
- **目标交付日期**: 2025-03-31
- **当前状态**: 进行中 - 架构设计阶段
- **整体进度**: 35% (28/80 tasks completed)

## 用户故事优先级

### P1 - 核心功能（必须实现）

| 用户故事 | 描述 | 状态 | 完成率 |
|---------|------|------|--------|
| US1 | 支持USB PD 3.0协议，输出5V/9V/12V/15V/20V @ 3A | 进行中 | 60% (12/20 tasks) |
| US2 | 输入电压范围85-265VAC，频率47-63Hz | 进行中 | 50% (5/10 tasks) |
| US3 | 效率符合DoE Level VI（满载>94%，轻载>85%） | 待开始 | 0% (0/8 tasks) |

**P1小计**: 2/3 用户故事进行中，1/3待开始，P1任务完成率 45% (17/38)

### P2 - 重要功能（通常需要）

| 用户故事 | 描述 | 状态 | 完成率 |
|---------|------|------|--------|
| US4 | 隔离耐压4000VAC，符合IEC 62368-1 | 进行中 | 40% (4/10 tasks) |
| US5 | EMC符合CISPR 32 Class B | 待开始 | 0% (0/12 tasks) |

**P2小计**: 1/2 用户故事进行中，1/2待开始，P2任务完成率 18% (4/22)

### P3 - 增值功能（可选）

| 用户故事 | 描述 | 状态 | 完成率 |
|---------|------|------|--------|
| US6 | 支持快充协议扩展（QC3.0, AFC） | 未计划 | 0% (0/20 tasks) |

**P3小计**: 未计划实现

## 项目里程碑

| 里程碑 | 目标日期 | 实际日期 | 状态 | 备注 |
|--------|---------|---------|------|------|
| M1: 完成需求规格 | 2025-01-15 | 2025-01-12 | ✓ 已完成 | 提前3天 |
| M2: 完成架构设计 | 2025-01-31 | - | 进行中 | 预计按时完成 |
| M3: 完成原理图设计 | 2025-02-15 | - | 待开始 | 依赖M2 |
| M4: 完成PCB布局设计 | 2025-02-28 | - | 待开始 | 依赖M3 |
| M5: 完成样机制作 | 2025-03-07 | - | 待开始 | 依赖M4 |
| M6: 通过功能测试 | 2025-03-15 | - | 待开始 | 依赖M5 |
| M7: 通过EMC测试 | 2025-03-25 | - | 待开始 | 依赖M6，**高风险** |
| M8: 完成试产验证 | 2025-03-31 | - | 待开始 | 依赖M7 |

## 任务进度统计

### 按优先级统计

| 优先级 | 总任务数 | 已完成 | 进行中 | 待开始 | 完成率 |
|--------|---------|--------|--------|--------|--------|
| P1 | 38 | 17 | 15 | 6 | 45% |
| P2 | 22 | 4 | 8 | 10 | 18% |
| P3 | 20 | 0 | 0 | 20 | 0% |
| **合计** | **80** | **21** | **23** | **36** | **26%** |

### 按阶段统计

| 阶段 | 总任务数 | 已完成 | 进行中 | 待开始 | 完成率 |
|------|---------|--------|--------|--------|--------|
| Phase 1: 需求分析 | 10 | 10 | 0 | 0 | 100% |
| Phase 2: 架构设计 | 15 | 8 | 7 | 0 | 53% |
| Phase 3: 详细设计 | 25 | 3 | 12 | 10 | 12% |
| Phase 4: 测试验证 | 30 | 0 | 4 | 26 | 0% |

## 风险跟踪

### 高风险

| 风险ID | 风险描述 | 风险类别 | 影响 | 缓解措施 | 责任人 | 状态 |
|--------|---------|---------|------|---------|--------|------|
| R001 | LLC变压器定制交期4-6周，可能延误M5 | 供应链 | 延期1-2周 | 提前下单，评估备选供应商 | 采购经理 | 监控中 |
| R002 | EMC测试首次通过率低（新设计），可能多次迭代 | 技术 | 延期2-4周 | 提前EMC预测试，优化布局设计 | 硬件工程师 | 缓解中 |
| R003 | Infineon MOSFET单一供应商，库存紧张 | 供应链 | 成本增加或延期 | 评估国产替代方案，备货 | BOM工程师 | 缓解中 |

### 中风险

| 风险ID | 风险描述 | 风险类别 | 影响 | 缓解措施 | 责任人 | 状态 |
|--------|---------|---------|------|---------|--------|------|
| R004 | 热设计仿真数据缺失，散热器尺寸待确认 | 技术 | 延期1周 | 补充热仿真，尽早确认散热器 | 硬件工程师 | 待处理 |
| R005 | PCB 4层板成本高于预算10% | 成本 | 成本增加 | 评估6层板方案（权衡EMC与成本） | 项目经理 | 评估中 |

### 低风险

| 风险ID | 风险描述 | 风险类别 | 影响 | 缓解措施 | 责任人 | 状态 |
|--------|---------|---------|------|---------|--------|------|
| R006 | 部分器件选型待确认（PD协议芯片） | 技术 | 延期3-5天 | 本周内完成选型 | BOM工程师 | 监控中 |

## 关键路径

以下任务位于项目关键路径上，延期将直接影响项目交付：

1. **T025** [M2里程碑] 完成架构设计评审 → 目标日期: 2025-01-31，**依赖**: T020-T024全部完成
2. **T040** [M3里程碑] 完成原理图设计 → 目标日期: 2025-02-15，**依赖**: T025, T030, T035
3. **T055** [M4里程碑] 完成PCB布局 → 目标日期: 2025-02-28，**依赖**: T040, DFM评估
4. **T065** [M7里程碑] 通过EMC测试 → 目标日期: 2025-03-25，**高风险**，**依赖**: M5, M6

**提示**: T065（EMC测试）是关键路径上的高风险里程碑，建议提前进行EMC预测试。

## 下一步行动（PM优先事项）

### 本周（2025-01-20 ~ 2025-01-26）

1. **[高优]** 推动LLC变压器供应商确认报价和交期（R001缓解）
2. **[高优]** 协调硬件工程师完成架构设计评审（M2里程碑）
3. **[中优]** 跟进BOM工程师完成PD协议芯片选型（R006）
4. **[中优]** 评估PCB 4层 vs 6层方案，平衡EMC与成本（R005）

### 下周（2025-01-27 ~ 2025-02-02）

1. **[高优]** 确认M2里程碑完成，启动详细设计阶段
2. **[高优]** 推动Infineon MOSFET备货或国产替代评估（R003缓解）
3. **[中优]** 安排热仿真分析，确认散热器设计（R004）

### 本月（2025-01）

1. 完成M2里程碑（架构设计）
2. 启动M3里程碑（原理图设计）
3. 解决所有高风险项的缓解措施

## 项目状态总结

- **进度**: 整体进度26%，P1任务完成45%，符合预期
- **里程碑**: M1已完成，M2进行中，预计按时完成
- **风险**: 3个高风险项需重点关注（变压器交期、EMC测试、MOSFET供应）
- **关注点**: EMC测试是关键路径上的高风险里程碑，建议提前预测试
- **建议**: 本周重点推动变压器供应商确认和架构设计评审
```
"""
